https://developer.mozilla.org/ko/docs/Web/API/Intersection_Observer_API

**Intersection Observer API**는 웹 페이지에서 요소(Element)가 뷰포트(Viewport)나 다른 요소와 교차할 때, 즉 화면에 나타나거나 사라질 때 그 변화를 감지하고 반응할 수 있게 해주는 JavaScript API입니다. 이 API를 사용하면 스크롤링이나 레이아웃 변화와 같은 이벤트를 처리하는 데 도움을 주며, 주로 다음과 같은 용도로 사용됩니다.

### 주된 용도:

1. **Lazy Loading (지연 로딩)**:
    - 이미지를 사용자 화면에 나타날 때만 로딩하도록 하여, 페이지의 성능을 향상시킵니다.
2. **무한 스크롤 (Infinite Scroll)**:
    - 사용자가 스크롤할 때 추가 콘텐츠를 불러오는 데 사용됩니다.
3. **요소의 가시성 감지**:
    - 특정 요소가 화면에 얼마나 보이는지를 감지하여 애니메이션을 트리거하거나, 분석 데이터를 수집할 수 있습니다.
4. **광고 또는 배너 노출 확인**:
    - 광고나 배너가 사용자의 뷰포트에 표시되었는지 감지하여 광고 노출 여부를 트래킹할 수 있습니다.

### 주요 개념:

- **IntersectionObserver** 객체를 생성하여 감시할 대상 요소(타겟)를 설정하고, 그 요소가 화면이나 다른 요소와 교차할 때마다 콜백을 실행합니다.

### 코드 예시:

```jsx

let options = {
  root: null, // 뷰포트가 기준
  rootMargin: "0px",
  threshold: 0.1 // 요소가 10% 이상 보일 때 콜백 호출
};

let observer = new IntersectionObserver((entries, observer) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      console.log('요소가 보이기 시작했습니다.');
      // 원하는 작업 실행
    }
  });
}, options);

// 감시할 요소 선택
let target = document.querySelector('.target-element');
observer.observe(target);

```

### 장점:

- **성능 최적화**: **스크롤 이벤트를 직접 사용하는 것보다 효율적입니다.** Intersection Observer는 브라우저가 효율적으로 처리하여 성능에 미치는 영향이 적습니다.
- **간결함**: 복잡한 뷰포트 계산이나 스크롤 이벤트 핸들링이 필요하지 않으며, 간단하게 요소의 가시성을 추적할 수 있습니다.

이 API는 특히 성능에 민감한 웹 애플리케이션에서 자주 사용됩니다.


# 성능적으로 좋은 이유

## 과거 방식

과거에는 화면에서 어떤 요소가 보이거나 사라지는지를 감지하려면, **모든 요소**에 대해 일일이 정보를 확인해야 했어요. 이 작업을 하려면 스크롤 이벤트가 발생할 때마다 **반복문**으로 각 요소의 위치를 계산하는 메서드(예: `Element.getBoundingClientRect()`)를 계속 호출해야 했습니다. 그런데 이 계산들은 **메인 스레드**에서 실행되었기 때문에, 만약 작업량이 많거나 복잡하면 **페이지 성능**이 느려질 수 있었죠.

결과적으로, 이러한 방식은 특히 **페이지가 로드될 때** 성능 문제가 생겨 **페이지가 끊기거나 부드럽지 않게** 보일 수 있었습니다.

무한 스크롤이 있는 웹 페이지를 떠올려 보세요. 예를 들어, 페이지를 스크롤하면 새로운 콘텐츠가 계속해서 아래로 추가되는 방식이죠. 여기에 광고를 관리하는 라이브러리와 애니메이션 효과를 만드는 그래픽 코드, 공지 박스를 표시하는 코드 등 여러 가지 기능이 추가됩니다.

각 기능에는 **교차 감지** 코드가 들어 있어, 화면에 요소가 보이거나 사라질 때마다 이를 감지합니다. 그런데 이 코드들은 모두 **메인 스레드**에서 실행됩니다. 즉, 페이지가 스크롤될 때마다 모든 감지 코드가 한꺼번에 작동하여 **브라우저에 부하**를 줍니다.

## **Intersection Observer API**를 사용하면

**Intersection Observer API**를 사용하면, 특정 요소가 화면에 나타나거나 사라질 때, 또는 요소가 얼마나 화면에 보이는지에 따라 **자동으로 실행되는 코드**(콜백 함수)를 설정할 수 있어요. 이렇게 하면 웹사이트는 더 이상 직접적으로 스크롤 이벤트를 계속 확인하지 않아도 되고, 브라우저가 알아서 이 과정을 최적화해 줍니다. 그래서 성능이 더 좋아질 수 있어요.

하지만 이 API가 주지 않는 정보도 하나 있어요. 바로 **정확히 몇 개의 픽셀이 겹치는지**나 **어떤 픽셀들이 겹치는지**는 알 수 없다는 점이죠. 대신, 이 API는 "요소가 대략 **N% 정도** 겹쳤을 때 어떤 작업을 할 것인지"와 같은 **일반적인 상황**을 처리하는 데 사용됩니다.

즉, 픽셀 단위로는 정확하지 않지만, 큰 범위에서 요소가 화면에 얼마나 보이는지에 따라 작동하도록 만들 수 있다는 겁니다.

## **Proxy** íŒ¨í„´ì´ë€?

íŠ¹ì • ê°ì²´ë¡œì˜ ì ‘ê·¼ì„ ì œì–´í•˜ëŠ” ëŒ€ë¦¬ì¸(íŠ¹ì • ê°ì²´ë¥¼ ëŒ€ë³€í•˜ëŠ” ê°ì²´)ì„ ì œê³µí•˜ëŠ” íŒ¨í„´ì„ ë§í•œë‹¤.

## êµ¬ì¡°

![image](https://github.com/jeongye01/TIL/assets/74299317/a3a8a790-6575-4cb6-9ea0-3bc0531c6378)


í”„ë¡ì‹œëŠ” **ë‹¤ë¥¸ ê°ì²´ì— ëŒ€í•œ ì ‘ê·¼ì„ ì œì–´í•˜ëŠ” ê°ì²´**ì´ë‹¤. ì—¬ê¸°ì„œ ë‹¤ë¥¸ ê°ì²´ë¥¼ ëŒ€ìƒ(Subject)ë¼ê³  ë¶€ë¥¸ë‹¤. í”„ë¡ì‹œì™€ ëŒ€ìƒì€ ë™ì¼í•œ ì¸í„°í˜ì´ìŠ¤ë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©° ì´ë¥¼ í†µí•´ ë‹¤ë¥¸ ì¸í„°í˜ì´ìŠ¤ì™€ ì™„ì „íˆ í˜¸í™˜ë˜ë„ë¡ ë°”ê¿€ ìˆ˜ ìˆë‹¤.

1. **Subject**
    
    Proxyì™€ RealSubjectë¥¼ í•˜ë‚˜ë¡œ ë¬¶ëŠ” ì¸í„°í˜ì´ìŠ¤(ë‹¤í˜•ì„±). 
    
2. **RealSubject**
    
    ì›ë³¸ ëŒ€ìƒ ê°ì²´
    
3. **Proxy**
    
    Clientì™€ ëŒ€ìƒ ê°ì²´(RealSubject)ë¥¼ ì¤‘ê³„í•  ëŒ€ë¦¬ì¸ ì—­í• 
    
    í”„ë¡ì‹œëŠ” ëŒ€ìƒ ê°ì²´ë¥¼ í•©ì„±í•œë‹¤.
    
    í”„ë¡ì‹œëŠ” ëŒ€ìƒ ê°ì²´ì™€ ê°™ì€ ì´ë¦„ì˜ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©°, ë³„ë„ì˜ ë¡œì§ì„ ìˆ˜í–‰ í•  ìˆ˜ ìˆë‹¤. ë³„ë„ì˜ ë¡œì§ì´ë¼ í•¨ì€ ëŒ€ìƒ ê°ì²´ë¥¼ í˜¸ì¶œ í•  ìˆ˜ ìˆëŠ” ê¶Œí•œ ë˜ëŠ” ìœ íš¨ì„± ê²€ì‚¬ ë“±ê³¼ ê°™ì€ ë¡œì§ì´ ë  ìˆ˜ ìˆë‹¤.
    
4. **Client**
    
    Subject ì¸í„°í˜ì´ìŠ¤ë¥¼ ì´ìš©í•˜ì—¬ í”„ë¡ì‹œ ê°ì²´ë¥¼ ìƒì„±í•´ ì´ìš©í•˜ëŠ” ì—­í• 
    

## íŠ¹ì§•

ê¸°ì¡´ ëŒ€ìƒ ê°ì²´ì˜ ì½”ë“œë¥¼ ë³€ê²½í•˜ì§€ ì•Šê³  ìƒˆë¡œìš´ ê¸°ëŠ¥ì„ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.

ë°ì½”ë ˆì´í„° íŒ¨í„´ê³¼ ìœ ì‚¬í•˜ë‹¤. ê¸°ëŠ¥ í™•ì¥ì— í•„ìš”í•œ ìƒˆë¡œìš´ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ê¸° ìœ„í•´ì„œ ëŒ€ìƒ ê°ì²´(Subject)ì˜ ì½”ë“œëŠ” ìˆ˜ì •í•˜ì§€ ì•Šê³ (ìˆ˜ì •ì—ëŠ” ë‹«í˜€ìˆìŒ) Proxy ì¸í„°í˜ì´ìŠ¤ì— ìƒˆë¡œìš´ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ê³  ëŒ€ìƒ ê°ì²´ì˜ ì¸í„°í˜ì´ìŠ¤ë¥¼ í˜¸ì¶œí•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ì¶”ê°€ê°€ ê°€ëŠ¥í•˜ë‹¤.

ëŒ€ìƒ ê°ì²´ëŠ” ìì‹ ì˜ ê¸°ëŠ¥ì—ë§Œ ì§‘ì¤‘í•˜ê³ , ê·¸ ì´ì™¸ ë¶€ê°€ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ì—­í• ì€ í”„ë¡ì‹œ ê°ì²´ì— ìœ„ì„í•¨ìœ¼ë¡œ ë‹¨ì¼ ì±…ì„ ì›ì¹™ì„ ìœ„ë°˜í•˜ì§€ ì•ŠëŠ”ë‹¤.

ì ‘ê·¼ ê¶Œí•œì´ë‚˜ ìƒì„±ì— ëŒ€í•œ ë¶€ë¶„ì„ í”„ë¡ì‹œì—ê²Œ ëª¨ë‘ ìœ„ì„í•˜ê³  ìì‹ ì´ ê°€ì§€ëŠ” ë‹¨ì¼ ì±…ì„ë§Œ ìˆ˜í–‰í•œë‹¤.

## ì‘ë™ ì›ë¦¬

ëŒ€ìƒ ê°ì²´(Subject)ì˜ ë©”ì„œë“œë¥¼ ì§ì ‘ ì‹¤í–‰í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ëŒ€ìƒ ê°ì²´ì— ì ‘ê·¼í•˜ê¸° ì „ì— í”„ë¡ì‹œ ê°ì²´ì˜ ë©”ì„œë“œë¥¼ ì ‘ê·¼ í•œ í›„ ì¶”ê°€ì ì¸ ë¡œì§ì„ ì²˜ë¦¬í•œ ë’¤ ì ‘ê·¼í•˜ê²Œ ëœë‹¤.

ê°„ë‹¨í•˜ê²Œ ë³´ë©´ Client â†’ Proxy â†’ After Operating Method of Proxy, Subject ìˆœì„œê°€ ëœë‹¤.

> ì˜ˆì‹œ ì½”ë“œ ì¶œì²˜; https://inpa.tistory.com/entry/GOF-ğŸ’ -í”„ë¡ì‹œProxy-íŒ¨í„´-ì œëŒ€ë¡œ-ë°°ì›Œë³´ì [Inpa Dev ğŸ‘¨â€ğŸ’»:í‹°ìŠ¤í† ë¦¬]
> 

### ê¸°ë³¸í˜• í”„ë¡ì‹œ

```java
interface ISubject {
    void action();
}

class RealSubject implements ISubject {
    public void action() {
        System.out.println("ì›ë³¸ ê°ì²´ ì•¡ì…˜ !!");
    }
}

```

```java
class Proxy implements ISubject {
    private RealSubject subject; // ëŒ€ìƒ ê°ì²´ë¥¼ composition

    Proxy(RealSubject subject) {
        this.subject = subject;
    }

    public void action() {
        subject.action(); // ìœ„ì„
        /* do something */
        System.out.println("í”„ë¡ì‹œ ê°ì²´ ì•¡ì…˜ !!");
    }
}

class Client {
    public static void main(String[] args) {
        ISubject sub = new Proxy(new RealSubject());
        sub.action();
    }
}
```

### ê°€ìƒ í”„ë¡ì‹œ

**Lazy Constructor(ì§€ì—° ì´ˆê¸°í™”) ë°©ì‹**

ê°€ë” í•„ìš”í•˜ì§€ë§Œ, í•­ìƒ ë©”ëª¨ë¦¬ì— ì ì¬ë˜ì–´ ìˆëŠ” ë¬´ê±°ìš´ ì„œë¹„ìŠ¤ ê°ì²´ê°€ ìˆëŠ” ê²½ìš°

ì´ êµ¬í˜„ì€ ì‹¤ì œ ê°ì²´ì˜ ìƒì„±ì— ë§ì€ ìì›ì´ ì†Œëª¨ë˜ì§€ë§Œ, ì‚¬ìš© ë¹ˆë„ëŠ” ë‚®ì„ ë•Œ ì ìš©í•˜ëŠ” ë°©ì‹

```java
class Proxy implements ISubject {
    private RealSubject subject; // ëŒ€ìƒ ê°ì²´ë¥¼ composition

    Proxy() {
    }

    public void action() {
    	// í”„ë¡ì‹œ ê°ì²´ëŠ” ì‹¤ì œ ìš”ì²­(action(ë©”ì†Œë“œ í˜¸ì¶œ)ì´ ë“¤ì–´ ì™”ì„ ë•Œ ì‹¤ì œ ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.
        if(subject == null){
            subject = new RealSubject();
        }
        subject.action(); // ìœ„ì„
        /* do something */
        System.out.println("í”„ë¡ì‹œ ê°ì²´ ì•¡ì…˜ !!");
    }
}

class Client {
    public static void main(String[] args) {
        ISubject sub = new Proxy();
        sub.action();
    }
}

```

### ë³´í˜¸ í”„ë¡ì‹œ

í”„ë¡ì‹œê°€ ëŒ€ìƒ ê°ì²´ì— ëŒ€í•œ ìì›ìœ¼ë¡œì˜ ì—‘ì„¸ìŠ¤ ì œì–´

íŠ¹ì • í´ë¼ì´ì–¸íŠ¸ë§Œ ì„œë¹„ìŠ¤ ê°ì²´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•´ì•¼í•˜ëŠ” ì¼€ì´ìŠ¤ì— ì ìš©! í•˜ì§€ë§Œ, Springì—ì„œëŠ” ì´ëŸ¬í•œ ë¶€ë¶„ì„ ì´ë¯¸ ì¸í„°í˜ì´ìŠ¤ë¡œ ì œê³µ**(Filter/Intercepter/AOP)**

í”„ë¡ì‹œ ê°ì²´ë¥¼ í†µí•´ í´ë¼ì´ì–¸íŠ¸ì˜ ìê²© ì¦ëª…ì´ ê¸°ì¤€ê³¼ ì¼ì¹˜í•˜ëŠ” ê²½ìš°ì—ë§Œ ì„œë¹„ìŠ¤ ê°ì²´ì—ê²Œ ìš”ì²­ ë©”ì„¸ì§€ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆê²Œ í•œë‹¤.

```java
class Proxy implements ISubject {
    private RealSubject subject; // ëŒ€ìƒ ê°ì²´ë¥¼ composition
    boolean access; // ì ‘ê·¼ ê¶Œí•œ

    Proxy(RealSubject subject, boolean access) {
        this.subject = subject;
        this.access = access;
    }

    public void action() {
        if(access) {
            subject.action(); // ìœ„ì„
            /* do something */
            System.out.println("í”„ë¡ì‹œ ê°ì²´ ì•¡ì…˜ !!");
        }
    }
}

class Client {
    public static void main(String[] args) {
        ISubject sub = new Proxy(new RealSubject(), false);
        sub.action();
    }
}
```

## ì–¸ì œ ì‚¬ìš©í•˜ë©´ ìœ ìš©í• ê¹Œ?

ê¸°ëŠ¥ í™•ì¥ë³´ë‹¤ëŠ” ì„œë¹„ìŠ¤ í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê¸° ì§ì „ì— ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ëŠ” **ì§€ì—° ë¡œë”© ë°©ì‹**ì´ë‚˜ ì„œë¹„ìŠ¤ í´ë˜ìŠ¤ì˜ ë©”ì„œë“œê°€ ì‹¤í–‰ë˜ê¸° ì „ì— ì ‘ê·¼ ê¶Œí•œ í™•ì¸ ë˜ëŠ” íŒŒë¼ë¯¸í„° ìœ íš¨ì„± ì²´í¬, ë¡œê¹… ì²˜ë¦¬ ë“± ì„œë¹„ìŠ¤ í´ë˜ìŠ¤ì˜ ë©”ì„œë“œ ì‹¤í–‰ ì „ì— ì‹¤í–‰ì„ í•´ì•¼í•˜ëŠ” ì¼€ì´ìŠ¤ì—ì„œ ì‚¬ìš©í•˜ë©´ ì¢‹ë‹¤.

ì‹¤ë¬´ì—ì„œëŠ” ì „ë¬¸API í†µì‹  ì‹œ, ë§ì´ ì‚¬ìš©ëœë‹¤. ì „ë¬¸ì„ ë§Œë“¤ê³  ì „ë¬¸API ì„œë²„ë¡œ ì§ì ‘ í†µì‹  í•˜ëŠ” ë°©ì‹ì´ ì•„ë‹ˆë¼ í”„ë¡ì‹œ ì„œë²„ë¥¼ í†µí•´ì„œ ì¸ì¦ ì ˆì°¨ë¥¼ ì§„í–‰í•œ í›„ì— ìš”ì²­í•œ ì „ë¬¸ì´ ì •ìƒì ìœ¼ë¡œ ì „ë¬¸API ì„œë²„ë¡œ ì „ë‹¬ë˜ê³  ì‘ë‹µì„ ë°›ì„ ìˆ˜ ìˆë‹¤.

- IAM = Identity and Access Management, Global service : AWS 서비스에 요청을 생성하기 위한 일련의 권한을 정의하고,  AWS 서비스에 의해 사용될 IAM 개체 

IAM에서는 사용자를 생성하고 그룹에 배치한다. 

계정을 생성할때 루트 계정이 기본으로 생성되며 오직 계정을 생성할때만 사용된다, 그 후에는 루트 계정을 더 이상 사용해서도, 공유해서도 안된다.

![image](https://github.com/jeongye01/TIL/assets/74299317/bcc2cddc-b467-4147-b9e7-8f22443b9e9d)


그룹에는 사용자만 배치할수있으며 다른 그룹을 포함시킬 수 없다. 

한 사용자는 다수의 그룹에 포함될 수 있다. 

- 사용자 또는 그룹에게 정책, 또는 IAM 정책이라고 불리는 JSON 문서를 지정할 수 있다.
    
    ![image](https://github.com/jeongye01/TIL/assets/74299317/e546339b-d305-4acd-8c74-967d4271d0cc)

    
- AWS에서는 보안 상 최소 권한의 원칙을 적용한다.

# IAM 정책

:AWS 서비스에 요청을 생성하기 위한 일련의 권한을 정의하며, IAM 사용자, 사용자 그룹 및 IAM  역할에서 사용하게 될 JSON 문서  
- 그룹의 정책은 구성원에게 상속된다. 아무 그룹에도 속하지 않는 사용자에게는 인라인 정책을 생성해서 부여할수 있다. 인라인 정책은 사용자가 그룹에 속한것과 상관없이 부여 할 수 있다.
- 정책 구조와 정책 명명법 : JSON 문서를 첨부할 수 있다.
    
    ![image](https://github.com/jeongye01/TIL/assets/74299317/6b59025a-5526-40cb-9462-cff5cdd9fa9f)

    
    - IAM 정책 구조 요소는 버전 숫자를 포함한다.
    - 정책 식별 Id는 선택사항이다.
    - 문장에는 아주 중요한 부분들이 들어있다.(시드, 효과, 원칙, 조치, 리소스, 그리고 조건으로 구성)
        - Sid :  문장의 식별자 (선택사항)
        - effect : 문장이 특정 API에 접근하는 걸 허용할지 거부할지에 대한 내용,(allow,deny)
        - principal : 특정 정책이 적용될 사용자,계정,혹은 역할
        - Action : effect에 기반해 허용 및 거부되는 API 호출의 목록
        - Resource : 적용될 action의 리소스의 목록
        - Condition: Statement가 언제 적용될지 결정 (선택사항)
        
        (어느 리소스에서 어느 액션이든지 허용한다. → 관리자 권한)
        
        ![image](https://github.com/jeongye01/TIL/assets/74299317/525f34b8-532e-48fa-a0f5-121ebb76b440)

 - 기본적으로 보안을 위해 최소 권한을 부여해야 한다.       

# IAM MFA

IAM 사용자 들은 자신만의 자격증명(사용자 이름 & 비밀번호, 혹은 액세스 키)을 통해 AWS 서비스에 액세스 한다.

그룹과 사용자들의 정보가 침해당하지 않도록 보호하는 두가지 방어 매커니즘

1. 비밀 번호 정책 정의 : 비밀번호 최소 길이 설정, 특정 유형의 글자 사용,IAM 사용자들의 비밀번호 변경을 허용 또는 금지, 일정 기간이 지나면 비밀번호를 만료시켜 새 비밀번호 설정을 요구, 사용자가 비밀번호의 재사용을 막아 비밀 번호 변경시에 동일한 비밀번호나 이전에 사용했던 비밀번호를 사용자지 못하게 막을 수도 있다.
    
    ![image](https://github.com/jeongye01/TIL/assets/74299317/21ee866c-2aaf-48cb-a402-d45c7b426e32)

    
2. MFA(다요소인증) : AWS에서는 이 메커니즘을 필수적으로 사용하도록 권장한다. 로그인 과정에서 비밀번호 + MFA 생성 토큰 함께 사용 → 해킹을 당해 비밀번호가 누출된 상황이라고 해도 해커에게는 로그인을 위해 휴대전화 등 물리적 장치가 추가로 필요해짐

### MFA 장치 옵션

- 가상 MFA 장치(Virtual MFA device)
- 범용 두번째 인자(U2F 보안키)
- 하드웨어 키 팝 MFA

# CLI & SDK

커맨드라인으로 CLI를 사용하여 서비스를 관리하거나, SDK를 사용하여

프로그래밍 언어로 AWS 서비스를 관리할 수 있다.

### AWS 엑세스 키

CLI로 AWS에 접근하려는 경우 또는 SDK를 통해 AWS에 접근하려는 경우 access key를 통해 보안을 향상시킬 수 있다.

access key는 AWS Console을 통해 생성된다.

사용자의 측면에서 access key는 비밀번호와 마찬가지로 암호화 같다. 자신만의 access key를 생성하게 되면 동료와 공유해서는 안된다. 

# IAM Role

AWS 서비스에 거는 권한.

# IAM 사용량을 감시
- IAM 자격증명 보고서 : IAM 보안도구,  AWS 계정의 모든 IAM 사용자와 이들의 다양한 자격 증명 상태가 포함되어 있다. 
- IAM 자격증명 보고서를 생성하고 IAM 엑세스 어드바이저 서비스를 통해 IAM 사용량을 감시할 수 있다.

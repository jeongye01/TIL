# 📚 TIL — PostgreSQL에서 `VARCHAR` vs `TEXT`

## 1. 기본 개념

- **`VARCHAR(n)`**
    - 최대 `n`자까지 허용하는 가변 길이 문자열 타입.
    - `n`보다 긴 값 입력 시 에러 발생.
- **`TEXT`**
    - 길이 제한이 없는 가변 길이 문자열 타입.
    - 사실상 무제한 길이 허용.

---

## 2. 내부 동작 차이

- PostgreSQL에서는 **`TEXT`, `VARCHAR(n)`, `VARCHAR` (제한 없음)** 모두 **같은 방식**으로 저장되고 처리됨.
- **성능 차이 없음** → 인덱싱, 정렬, 검색 모두 동일하게 동작.
- 차이는 오직 **길이 제한 유무**.

---

## 3. 장단점 비교

| 구분 | `VARCHAR(n)` | `TEXT` |
| --- | --- | --- |
| **길이 제한** | 있음 (`n`자 제한) | 없음 |
| **무결성** | DB 레벨에서 자동으로 길이 제한 보장 | 별도 제약 필요 |
| **성능** | 동일 | 동일 |
| **표준 SQL 호환성** | 표준 타입 | 비표준 타입 |
| **변경 용이성** | 제한 변경 시 스키마 수정 필요 | 변경 불필요 |
| **코드 가독성** | 데이터 규칙이 명확할 때 유리 | 제한이 필요 없을 때 단순 |

---

## 4. 사용 가이드

1. **명확한 최대 길이 규칙이 있는 경우** → `VARCHAR(n)`
    
    예: 전화번호(15자), 우편번호(10자), 국가 코드(3자)
    
2. **길이 제한이 없거나 애매한 경우** → `TEXT`
    
    예: 제품 설명, 리뷰, 블로그 본문
    
3. 길이 제한이 필요하지만 `TEXT`를 쓰고 싶을 때는:
    
    ```sql
    sql
    복사편집
    CREATE TABLE example (
        content TEXT CHECK (length(content) <= 500)
    );
    
    ```
    
    → 타입은 유연하게 유지, 무결성은 제약 조건으로 보장.
    

---

## 5. 결론

- **PostgreSQL에서는 `TEXT`와 `VARCHAR`의 성능 차이가 없다.**
- 길이 제한이 중요한 비즈니스 규칙이면 `VARCHAR(n)`,
    
    아니라면 `TEXT`가 관리와 유지보수에 유리하다.
    

---

💡 **오늘 배운 점**

PostgreSQL에서는 문자열 타입 선택이 성능 문제가 아니라 **도메인 규칙**과 **무결성** 중심으로 이뤄져야 한다.

MySQL처럼 `TEXT`의 제약이 많은 DBMS와 달리, PostgreSQL은 `TEXT`를 기본으로 쓰고 필요한 경우만 `VARCHAR(n)`으로 제한하는 것이 실무에서 더 편하다.

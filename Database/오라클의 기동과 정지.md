# 오라클 기동시 사용하는 파일

1. 파라미터 파일 :



# 오라클 기동 4가지 상태

- OPEN : 데이터 처리를 할 수 있는 상태. SQL을 처리 할 수 있는 상태.
- MOUNT : 데이터 파일 등에 접근 할 수 있는 상태.(컨트롤 파일을 읽은 상태)
- NOMOUNT : 백그라운드 프로세스가 기동되고 공유 메모리를 할당 받은 상태
- SHUTDOWN : 정지 상태

<img width="342" alt="image" src="https://github.com/jeongye01/TIL/assets/74299317/eee99f0c-53f5-4ada-a595-8e3f01e15cca">

### 오라클 기동시 사용하는 파일

*파라미터 파일 : Oracle 데이터베이스가 기동될 때 제일 먼저 읽는 파일. 이 파일에는 데이터베이스 인스턴스가 기동될 때 필요한 초기화 파라미터들이 포함되어 있다. 이 파일을 통해 서버 프로세스를 기동시키고, 공유 메모리를 할당 받는다. 
*컨트롤 파일 : 데이터 베이스의 구성 정보가 적혀 있는 파일. 데이터베이스의 파일 경로 등을 알 수 있음

*데이터 파일 : 데이터가 보관된 파일

*REDO 로그 파일 : 데이터의 변경 이력을 보관하는 파일

MOUNT → OPEN : REDO 로그 파일을 열어서 오라클이 내부적으로 사용하는 정보와 비교하여 문제가 있는지를 확인 

# 인스턴스,데이터베이스 + 주요 파일 구성

### 인스턴스

 오라클에서의 인스턴스는 백그라운드 프로세스+ 공유 메모리를 의미한다. NOMOUNT 상태는 인스턴스가 기동한 상태다. 따라서 데이터 베이스와는 다르다. 그러나 일반적으로 인스턴스와 데이터베이스는 일대일로 대응하므로 인스턴스를 데이터베이스라고 불러도 그렇게 큰 문제는 없다.  단 RAC를 사용하는 경우에는 인스턴스와 데이터베이스가 일대일로 대응하지 않기 때문에 인스턴스와 데이터베이스의 차이를 명확히 이해할 필요가 있다.

<img width="615" alt="image" src="https://github.com/jeongye01/TIL/assets/74299317/38ac5772-4878-4141-b039-ee28b9be9784">

<img width="692" alt="image" src="https://github.com/jeongye01/TIL/assets/74299317/7c5b7611-27f7-4330-a1e6-2442efc35d23">


# 구체적인 기동 처리 흐름

### 1. SHUTDOWN에서 NOMOUNT로 전환

ORACLE_HOME과 ORACLE_SID 환경 변수를 토대로 초기화 파라미터 파일을 찾아서 읽어오며, 파일에서 읽어온 파라미터를 토대로 공유 메모리를 확보하고 백그라운드 프로세스를 생성한다. 

### 2. NOMOUNT로부터 MOUNT로 전환

초기화 파라미터에 기술된 컨트롤 파일의 경로를 사용해 컨트롤 파일을 열어 내용을 읽어오는 것으로 REDO 로그 파일이나 데이터 파일의 위치 파악

### 3. MOUNT에서 OPEN으로 전환

데이터 파일을 열어서 간단한 점검을 하고, 백그라운드 프로세스를 기동.

오라클 클라이언트에 서비스를 제공하는 서버 프로세스는 데이터베이스 기동 시에는 존재하지 않는다. 클라이언트에서 접속 요청이 있을 때 응답하는 형태로 생성됨.

# 오라클 정지

정지 작업은 기동 작업의 역순으로 데이터베이스를 닫은 후에 인스턴스를 종료한다. 인스턴스의 정지라는 것은 공유 메모리를 반환하고 백그라운드 프로세스를 정지하는 것을 말한다.

인스턴스 정지 시, 버퍼 캐시에 분산된 데이터를 정리하는 작업이 필요하다.

성능상의 이유로 변경된 데이터를 즉시 데이터 파일에 저장하지 않는다. 따라서 기록하지 않은 변경된 데이터를 데이터 파일에 기록해야 한다. 

### shutdown 옵션

<img width="520" alt="image" src="https://github.com/jeongye01/TIL/assets/74299317/e3ab4e14-5783-49b5-823f-8f11c52225b2">


abort 옵션은 다음 기동 시에 데이터를 복구한다. (인스턴스 복구)

데이터 파일에 기록하지 않은 데이터는 REDO 로그 파일의 데이터를 사용해서 복구한다.

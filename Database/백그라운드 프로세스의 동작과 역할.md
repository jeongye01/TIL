기본적으로 슬립 상태에서는 CPU를 소비하지 않으므로 프로세스의 수는 크게 중요하지 않다.

슬립 상태가 많은 상황은 오라클 이외의 소프트웨어에서도 마찬가지이다. 주위에서 쉽게 볼 수 있는 일반적인 장비에서도 CPU는 한두 개인데, 프로세스는 수십개에서 수백까지 활성화 되어 있는 상태가 많다. 이 말은, 대부분 프로세스는 많은 시간을 슬립한 상태로 있다는 것을 의미한다. 

백그라운드 프로세스 중 몇 가지는 쉬지 않고 정기적으로 작업을 한다. 이것은 OS의 웨이크업(Wake Up) 기능을 사용하고 있다. 몇 초에서 몇십 초, 길게는 몇 시간마다 눈을 뜨게 설정되어 있으며, 눈을 뜰 때마다 작업을 수행한다. 

# DBWR의 동작과 역할

DBWR은 변경된 데이터를 캐시에서 디스크로 기록하는 역할을 한다. 하지만 커밋한 시점에 기록하는 것은 아니며, 나중에 한번에 수행한다. 그 대신 LGWR이라고 하는 백그라운드 프로세스가 커밋한 시점의 REDO 로그(데이터 변경 정보)를 디스크에 기록한다. REDO 로그가 디스크에 기록되어 있으면, 만에 하나라도 DBWR이 데이터를 기록하지 못했더라도 복구할 수 있다, LGWR은 REDO 로그 파일에 REDO 로그를 기록하며, ARCH라는 백그라운드 프로세스가 아카이브 REDO 로그 파일에 기록한다. 

<img width="697" alt="image" src="https://github.com/jeongye01/TIL/assets/74299317/72c1410f-4d35-4830-a8cf-8fc2a1bd82dd">

### 동기 I/O vs 비동기 I/O

- 동기 I/O : 한 개의 I/O 처리가 끝나기 전까지는 다음 처리를 할 수 없음.
- 비동기 I/O : I/O가 종료하기 저에 다음 처리를 실행할 수 있는 I/O . 여러 개의 I/O 를 동시에 처리할 수 있기 때문에 디스크를 효율적으로 사용하게 된다.

# LGWR의 동작과 역할

LGWR은 커밋했을 때 REDO 로그를 기록하고, 커밋을 하지 않았어도 3초에 한 번 깨어나서 로그 버퍼에 데이터를 기록한다 

# SMON의 동작과 역할

공간 전문 청소 업체로 비유할 수 있다. 

테이블스페이스 안의 빈 공간들을 합치거나(ex.단편화된 공간의 정리,  UNDO 세그먼트의 크기 조정) 처리 도중에 종료된 트랜잭션을 롤백 한다던가, 임시 세그먼트를 청소한다. 

데이터베이스가 비정상 종료된 후 재기동할때 인스턴스 복구 처리를 수행한다. 

# PMON의 동작과 역할

메모리와 프로세스 전문 청소업체로 비유할수 있다.

**다른 프로세스가 비정상 종료되지 않았는가를 점검하며, 발견했을 때는 정리하는 역할을 수행한다.**

서버 프로세스가 비정상 종료했을 때 메모리나 프로세스를 정리한다. 필요할 때는 세션이나 프로세스를 청소하거나, 정리된 프로세스가 내부 Lock이나 메모리를 보유하고 있다면 그것을 해제한다. 

PMON은 다른 프로세스들을 감시하지만, PMON 자신이 비정상 종료하게 된다면 인스턴스가 정지한다. 

# LREG의 동작과 역할

인스턴스의 정보, 현재 프로세스의 수, 인스턴스의 부하를 리스너에게 등록하는 작업을 한다. 오라클 11g까지는 PMON이 이런 처리를 수행했지만, 오라클 12c 이후에서는 LPEG가 전용 프로세스 역할을 이어 받았다.

listener.ora 파일에 인스턴스의 정보를 등록하지 않더라도, 리스너는 인스턴스의 정보를 알고 있는 경우가 있는데, 이는 LREG가 리스너에게 정보를 등록했기 때문이다. 

# ARCH의 동작과 역할

REDO 로그 파일을 아카이브하는 프로세스이다. 

# CKPT

체크 포인트를 할때 데이터 파일의 헤더에 관리 정보를 기록하는 프로세스이다. 

<img width="707" alt="image" src="https://github.com/jeongye01/TIL/assets/74299317/de7d7262-9dc2-4f48-aef1-dc26fd999cc7">

<img width="703" alt="image" src="https://github.com/jeongye01/TIL/assets/74299317/48e123b0-5ba5-42de-ad53-1391122d4b77">
